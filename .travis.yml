language: cpp
compiler: gcc
dist: trusty

before_install:
    # C++17
    - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
    - sudo apt-get update -qq

install:
    # C++17
    - sudo apt-get install -qq g++-6
    - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-6 90
    # Codecov
    - sudo update-alternatives --install /usr/bin/gcov gcov /usr/bin/gcov-6 90
    - sudo pip install codecov

script:
    -   for filename in ./codes/*.cpp; do
            g++ -std=c++11 -c ${filename} -o ${filename}.o;
            g++ -std=c++11 ${filename}.o -o ${filename}.run;
            ${filename}.run;
            gcov -n -o ./codes/ ${filename} > /dev/null;
            mv ${filename}.cpp.gcno ${filename}.gcno
            rm -f ${filename}.run;
            rm -f ${filename}.o;
        done
    - codecov
